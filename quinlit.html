<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>QuinLit</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #121212;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .board {
            display: grid;
            grid-template-rows: repeat(6, 1fr);
            gap: 6px;
            margin-bottom: 20px;
        }
        .row {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
        }
        .tile {
            width: 55px;
            height: 55px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            text-transform: uppercase;
            border: 2px solid #3a3a3c;
            border-radius: 8px;
            transition: transform 0.2s ease-in-out;
            cursor: default;
        }
        /* Tile states */
        .tile.correct {
            background-color: #538d4e; /* Green */
            border-color: #538d4e;
            transform: scale(1.05);
        }
        .tile.wrong-position {
            background-color: #b59f3b; /* Yellow */
            border-color: #b59f3b;
        }
        .tile.not-in-word {
            background-color: #3a3a3c; /* Gray */
            border-color: #3a3a3c;
        }
        /* Keyboard states */
        .key {
            background-color: #818384;
            color: white;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: bold;
            padding: 10px 12px;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s;
            touch-action: manipulation;
        }
        .key:active {
            transform: scale(0.95);
        }
        .key.correct {
            background-color: #538d4e; /* Green */
        }
        .key.wrong-position {
            background-color: #b59f3b; /* Yellow */
        }
        .key.not-in-word {
            background-color: #3a3a3c; /* Gray */
        }
        /* Shake animation for invalid words */
        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
            transform: translate3d(0, 0, 0);
            backface-visibility: hidden;
            perspective: 1000px;
        }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        .message-box {
            position: absolute;
            top: 20px;
            background-color: rgba(255, 255, 255, 0.85);
            color: #333;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            pointer-events: none;
        }
        .message-box.show {
            opacity: 1;
        }
        .button-reset {
            background-color: #4a4a4a;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .button-reset:hover {
            background-color: #6a6a6a;
        }
        .new-game-button-container {
            margin-top: 20px;
        }
        .key {
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
    }
    </style>
</head>
<body class="bg-[#1a1a1a] text-white flex flex-col items-center p-4">

    <div class="message-box rounded-lg" id="messageBox"></div>

    <h1 class="text-4xl font-bold mb-8">QuinLit</h1>

    <div id="board" class="board"></div>

<div id="keyboard" class="mt-8 flex flex-col items-center gap-2 w-full max-w-sm">
    <div class="flex justify-center gap-1 w-full">
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="Q">Q</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="W">W</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="E">E</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="R">R</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="T">T</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="Y">Y</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="U">U</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="I">I</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="O">O</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="P">P</button>
    </div>
    <div class="flex justify-center gap-1 w-full">
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="A">A</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="S">S</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="D">D</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="F">F</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="G">G</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="H">H</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="J">J</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="K">K</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="L">L</button>
    </div>
    <div class="flex justify-center gap-1 w-full">
        <button id="enter" class="key flex-grow basis-1/6 text-sm py-2 px-1" data-key="Enter">Enter</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="Z">Z</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="X">X</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="C">C</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="V">V</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="B">B</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="N">N</button>
        <button class="key flex-grow basis-0 text-sm py-2 px-1" data-key="M">M</button>
        <button id="backspace" class="key flex-grow basis-1/6 text-sm py-2 px-1" data-key="Backspace">DEL</button>
    </div>
</div>
    <div id="newGameButtonContainer" class="new-game-button-container hidden">
        <button id="newGameButton" class="button-reset">New Game</button>
    </div>

<script>
    // --- Configuration ---
    let WORD_LIST = []; // Will be populated by fetch
    const NUM_ROWS = 6;
    const NUM_COLS = 5;
    
    // *** IMPORTANT: Replace with the Raw URL of your words.txt file on GitHub ***
    const WORD_LIST_URL = 'words.txt'; 
    // Example format: 'https://raw.githubusercontent.com/YourUsername/YourRepo/main/words.txt'

    // --- Game State Variables ---
    let targetWord = '';
    let currentGuess = '';
    let currentRow = 0;
    let gameOver = false;
    let keyboardStates = {};

    // --- DOM Elements ---
    const boardElement = document.getElementById('board');
    const messageBox = document.getElementById('messageBox');
    const newGameButtonContainer = document.getElementById('newGameButtonContainer');
    const newGameButton = document.getElementById('newGameButton');
    
    // --- Word List Loading ---
    async function loadWordList() {
        showMessage("Loading word list...");
        try {
            const response = await fetch(WORD_LIST_URL);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const text = await response.text();
            // Split the text by newline, filter out empty lines, and convert to lowercase
            WORD_LIST = text.split('\n')
                            .map(word => word.trim().toLowerCase())
                            .filter(word => word.length === NUM_COLS); // Only include 5-letter words

            if (WORD_LIST.length === 0) {
                throw new Error("Word list is empty or contains no 5-letter words.");
            }
            
            showMessage("Word list loaded! Starting game...");
            // Start the game once the word list is loaded
            startNewGame(); 
        } catch (error) {
            console.error('Failed to load word list:', error);
            showMessage(`Error: Could not load word list. Check console.`);
            // Set game over to prevent interaction without a word list
            gameOver = true;
        }
    }
    
    // --- Game Logic Functions ---

    // Initializes the game, setting the target word and resetting state.
    function startNewGame() {
        if (WORD_LIST.length === 0) {
            showMessage("Error: Word list not loaded. Please try again.");
            return;
        }

        targetWord = WORD_LIST[Math.floor(Math.random() * WORD_LIST.length)];
        currentGuess = '';
        currentRow = 0;
        gameOver = false;
        initializeKeyboardStates();
        
        // Reset DOM
        boardElement.innerHTML = '';
        for (let i = 0; i < NUM_ROWS; i++) {
            const rowEl = document.createElement('div');
            rowEl.className = 'row';
            for (let j = 0; j < NUM_COLS; j++) {
                const tileEl = document.createElement('div');
                tileEl.className = 'tile';
                rowEl.appendChild(tileEl);
            }
            boardElement.appendChild(rowEl);
        }
        
        newGameButtonContainer.classList.add('hidden');
        renderKeyboard();
    }
    
    // Handles key presses from either touch or click events
    function handleKeyAction(key) {
        if (gameOver) return;

        if (key === 'Enter') {
            submitGuess();
        } else if (key === 'Backspace') {
            removeLetter();
        } else if (key.length === 1 && key.match(/[a-zA-Z]/)) {
            addLetter(key);
        }
        
        hapticFeedback();
    }

    // Enables haptic feedback on keystrokes
    function hapticFeedback() {
        if ("vibrate" in navigator) {
            navigator.vibrate(50);
        }
    }
    
    // Displays a temporary message to the user.
    function showMessage(text) {
        messageBox.textContent = text;
        messageBox.classList.add('show');
        setTimeout(() => {
            messageBox.classList.remove('show');
        }, 2000);
    }

    // Initializes the keyboard state for all letters.
    function initializeKeyboardStates() {
        keyboardStates = {};
        const alphabet = "abcdefghijklmnopqrstuvwxyz";
        for (const char of alphabet) {
            keyboardStates[char] = 'unused';
        }
    }

    // Renders the keyboard buttons based on the game state.
    function renderKeyboard() {
        const keys = document.querySelectorAll('.key');
        keys.forEach(key => {
            const letter = key.dataset.key.toLowerCase();
            if (keyboardStates[letter]) {
                key.className = `key col-span-1 ${keyboardStates[letter]}`;
            } else if (letter === 'enter' || letter === 'backspace') {
                    // Do nothing, these buttons don't have a state
            }
        });
    }

    // Handles a letter input.
    function addLetter(letter) {
        if (gameOver || currentGuess.length >= NUM_COLS) {
            return;
        }
        currentGuess += letter.toLowerCase();
        updateBoard();
    }

    // Handles backspace input.
    function removeLetter() {
        if (gameOver || currentGuess.length === 0) {
            return;
        }
        currentGuess = currentGuess.slice(0, -1);
        updateBoard();
    }

    // Updates the visual representation of the board with the current guess.
    function updateBoard() {
        const tiles = boardElement.children[currentRow].children;
        for (let i = 0; i < NUM_COLS; i++) {
            tiles[i].textContent = currentGuess[i] ? currentGuess[i].toUpperCase() : '';
        }
    }

    // Handles the submission of a guess.
    function submitGuess() {
        if (gameOver || currentGuess.length !== NUM_COLS) {
            if (currentGuess.length !== NUM_COLS) {
                showMessage("Guess must be 5 letters");
                shakeBoard();
            }
            return;
        }
        
        // Check if the word is in the list
        if (!WORD_LIST.includes(currentGuess)) {
            showMessage("Not a valid word");
            shakeBoard();
            return;
        }

        // Evaluate the guess and update the tiles
        evaluateGuess();
        
        // Check for game over conditions
        if (currentGuess === targetWord) {
            gameOver = true;
            showMessage("You got it!");
            newGameButtonContainer.classList.remove('hidden');
        } else if (currentRow === NUM_ROWS - 1) {
            gameOver = true;
            showMessage(`Out of guesses! The word was ${targetWord.toUpperCase()}`);
            newGameButtonContainer.classList.remove('hidden');
        } else {
            // Move to the next row
            currentRow++;
            currentGuess = '';
        }
    }

    // Evaluates the current guess and applies the correct colors.
    function evaluateGuess() {
        const guessLetters = currentGuess.split('');
        const targetLetters = targetWord.split('');
        const tiles = boardElement.children[currentRow].children;
        const usedTargetIndices = new Set();
        
        // First pass: find correct letters
        for (let i = 0; i < NUM_COLS; i++) {
            if (guessLetters[i] === targetLetters[i]) {
                tiles[i].classList.add('correct');
                keyboardStates[guessLetters[i]] = 'correct';
                usedTargetIndices.add(i);
            }
        }
        
        // Second pass: find wrong-position and not-in-word letters
        for (let i = 0; i < NUM_COLS; i++) {
            if (tiles[i].classList.contains('correct')) continue;
            
            const letter = guessLetters[i];
            
            let isWrongPosition = false;
            // Search the target word for the letter in a spot that hasn't been matched yet
            for (let j = 0; j < NUM_COLS; j++) {
                if (!usedTargetIndices.has(j) && letter === targetLetters[j]) {
                    tiles[i].classList.add('wrong-position');
                    
                    // Update keyboard state (prioritize correct > wrong-position)
                    const currentKeyStatus = keyboardStates[letter];
                    if (currentKeyStatus !== 'correct') {
                        keyboardStates[letter] = 'wrong-position';
                    }
                    
                    usedTargetIndices.add(j); // Mark this target letter as used
                    isWrongPosition = true;
                    break;
                }
            }
            
            if (!isWrongPosition) {
                tiles[i].classList.add('not-in-word');
                // Update keyboard state
                const currentKeyStatus = keyboardStates[letter];
                if (currentKeyStatus !== 'correct' && currentKeyStatus !== 'wrong-position') {
                    keyboardStates[letter] = 'not-in-word';
                }
            }
        }
        renderKeyboard();
    }

    // Adds a shaking animation to the board.
    function shakeBoard() {
        const currentRowEl = boardElement.children[currentRow];
        currentRowEl.classList.add('shake');
        setTimeout(() => {
            currentRowEl.classList.remove('shake');
        }, 500);
    }

    // --- Event Listeners ---
    newGameButton.addEventListener('click', startNewGame);

    // Touch event listener for mobile devices
    document.getElementById('keyboard').addEventListener('touchstart', (e) => {
        e.preventDefault();
        const button = e.target.closest('button');
        if (button) {
            const key = button.dataset.key;
            if (key) {
                handleKeyAction(key);
            }
        }
    }, { passive: false });

    // Click event listener for desktop browsers
    document.getElementById('keyboard').addEventListener('click', (e) => {
        const button = e.target.closest('button');
        if (button) {
            const key = button.dataset.key;
            if (key) {
                handleKeyAction(key);
            }
        }
    });

    // Handle physical keyboard presses
    document.addEventListener('keydown', (e) => {
        // Prevent default browser behavior for certain keys (like Enter or Backspace)
        if (e.key === 'Enter' || e.key === 'Backspace') {
            e.preventDefault();
        }
        
        if (gameOver) return;

        const key = e.key.toUpperCase();
        if (key === 'ENTER') {
            handleKeyAction('Enter');
        } else if (key === 'BACKSPACE') {
            handleKeyAction('Backspace');
        } else if (key.length === 1 && key.match(/[A-Z]/)) {
            handleKeyAction(key);
        }
    });
    
    // Start the word loading process
    loadWordList();
</script>
</body>
</html>
